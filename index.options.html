<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>jQuery Selz Plugin</title>
		<link href="http://cdn.selz.com/jquery/1.0.5/jquery.selz.min.css" rel="stylesheet">
	</head>
	<body>
		<ul>
			<li><a href="http://selz.co/1gfLTzi" data-tracking="ABCD1234">Buy now</a></li>
		</ul>
		
		<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
		<script src="http://cdn.selz.com/jquery/1.0.5/jquery.selz.min.js"></script>
		<script>
			// Send beacon fallback
			navigator.sendBeacon = navigator.sendBeacon || function (url, data) {
				var xhr = new XMLHttpRequest();
				xhr.open("POST", url, false);
				xhr.send(data);
			};

			$(function () { 
				$.selz({
					theme: {
						button: {
							bg:             "#5fa9df",
							text:           "#fff"
						},
						checkout: {
							headerBg:       "#5fa9df",
							headerText:     "#fff"
						}
					},
					prefetch: true,
					getTracking: function($link) {
						return $link.data("tracking");
					},
					onDataReady: function ($link, data) {
						$link.html("<img src='" + data.ImageUrlSmall + "' alt='" + data.Title + "'><br>" + data.Title);
					},
					onModalOpen: function ($link) {
						console.log("Overlay opened for " + $link.attr("href"));
					},
					onPurchase: function (data) {
						console.log(data);
					},
					onProcessing: function (data) {
						console.log(data);
					},
					onClose: function ($link, data) {
						if(typeof data.modal_url === "string"){
							$link.data("modal-url", data.modal_url);
						}

						// Send data to your server on modal/tab/window close
						navigator.sendBeacon("http://requestb.in/1abpybo1", JSON.stringify(data));
					}
				});
			});
		</script>
	</body>
</html>